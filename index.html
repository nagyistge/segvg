

<!DOCTYPE html>

<html>

<head>

  <meta charset="UTF-8"/>

  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"/>

  <meta name="apple-mobile-web-app-capable" content="yes"/>

  <meta name="apple-touch-fullscreen" content="yes"/>

  <meta name="msapplication-tap-highlight" content="no"/>

  <link rel="stylesheet" href="assets/css/style.css"/>

  <script src="assets/js/jquery.js"></script>

  <script src="assets/js/paper.js"></script>

  <script src="assets/js/codemirror.js"></script>

  <script src="assets/js/scripts.js"></script>

  <title>Segvg: Segmentation to SVG</title>

</head>

  <body class="fullscreen">

<article><div class="paperscript">

<div class="buttons">

<button class="button" id="export-svg">svg</button>

<button class="button" id="export-json">json</button>

<div class="button run">Source</div>

<div class="explain">



</div>

</div>

<script type="text/paperscript" canvas="canvas-1">



// Export Functions

function downloadDataUri(options) {

	if (!options.url)

		options.url = "http://download-data-uri.appspot.com/";

	$('<form method="post" action="' + options.url

		+ '" style="display:none"><input type="hidden" name="filename" value="'

		+ options.filename + '"/><input type="hidden" name="data" value="'

		+ options.data + '"/></form>').appendTo('body').submit().remove();

}



$('#export-svg').click(function() {

	var svg = paper.project.exportSVG({ asString: true });

	downloadDataUri({

		data: 'data:image/svg+xml;base64,' + btoa(svg),

		filename: 'segvg.svg'

	});

});



$('#export-json').click(function() {

	var svg = paper.project.exportJSON({ asString: true });

	downloadDataUri({

		data: 'data:image/svg+xml;base64,' + btoa(svg),

		filename: 'segvg.json'

	});

});



var hitOptions = {

    segments: true,

    stroke: true,

    fill: true,

    tolerance: 5

};



var scalingfactor = 10;

var segments = [{'points': [[29, 22], [30, 21], [34, 21], [37, 24], [37, 28], [35, 30], [29, 30], [28, 31], [27, 31], [26, 30], [26, 29], [25, 28], [25, 26], [26, 25], [26, 24], [28, 22]], 'center': [31, 8]}, {'points': [[28, 21], [29, 20], [42, 20], [44, 22], [45, 22], [46, 23], [46, 25], [47, 26], [47, 30], [44, 33], [39, 33], [38, 34], [37, 34], [36, 33], [34, 33], [33, 32], [31, 32], [30, 31], [30, 29], [29, 28], [30, 27], [29, 26], [29, 25], [30, 24], [31, 24], [32, 23], [32, 22], [31, 22], [30, 23], [29, 23], [28, 22]], 'center': [31, 8]}, {'points': [[16, 8], [20, 8], [22, 10], [23, 10], [25, 12], [25, 13], [24, 14], [24, 19], [25, 20], [25, 23], [23, 25], [19, 25], [18, 24], [18, 22], [17, 22], [16, 21], [12, 21], [11, 20], [11, 17], [10, 16], [10, 15], [9, 14], [9, 13], [11, 11], [12, 11], [13, 10], [14, 10]], 'center': [31, 8]}, {'points': [[16, 30], [17, 29], [19, 29], [20, 30], [23, 30], [24, 29], [25, 30], [25, 33], [26, 34], [26, 35], [27, 36], [28, 36], [29, 37], [29, 38], [30, 39], [28, 41], [26, 41], [25, 42], [24, 41], [17, 41], [12, 36], [11, 36], [10, 35], [10, 33], [13, 30]], 'center': [31, 8]}, {'points': [[34, 15], [35, 14], [40, 14], [42, 16], [44, 16], [46, 18], [48, 18], [50, 20], [50, 23], [52, 25], [52, 26], [51, 27], [49, 27], [48, 28], [47, 27], [46, 27], [45, 26], [45, 25], [43, 25], [42, 24], [42, 25], [41, 26], [40, 25], [40, 24], [39, 24], [38, 23], [37, 23], [36, 22], [36, 21], [34, 19]], 'center': [31, 8]}, {'points': [[13, 12], [18, 12], [20, 14], [22, 12], [24, 12], [26, 14], [28, 14], [29, 15], [29, 18], [28, 19], [27, 19], [28, 20], [27, 21], [25, 21], [25, 22], [24, 23], [24, 24], [25, 25], [25, 26], [26, 27], [23, 30], [22, 30], [21, 29], [19, 29], [18, 28], [19, 27], [18, 27], [17, 26], [17, 25], [15, 23], [13, 23], [12, 22], [12, 19], [13, 18], [12, 17], [12, 16], [11, 15], [11, 14]], 'center': [31, 8]}, {'points': [[42, 6], [43, 6], [45, 8], [47, 8], [48, 9], [48, 10], [49, 11], [49, 12], [53, 12], [54, 13], [54, 14], [55, 15], [55, 17], [56, 17], [57, 18], [57, 21], [56, 22], [55, 22], [54, 21], [52, 21], [52, 22], [51, 23], [50, 22], [50, 21], [46, 21], [45, 20], [44, 20], [43, 19], [42, 19], [40, 17], [40, 15], [41, 14], [40, 13], [40, 10], [41, 9], [40, 8]], 'center': [31, 8]}, {'points': [[24, 25], [26, 25], [27, 26], [27, 28], [29, 30], [30, 30], [31, 31], [34, 31], [35, 30], [38, 30], [39, 31], [41, 31], [42, 32], [44, 32], [45, 33], [45, 36], [46, 36], [47, 37], [46, 38], [47, 39], [47, 40], [46, 41], [39, 41], [38, 40], [38, 39], [35, 39], [33, 37], [31, 37], [30, 36], [30, 35], [29, 35], [29, 36], [28, 37], [27, 37], [26, 36], [26, 35], [22, 35], [21, 34], [21, 33], [17, 33], [16, 32], [16, 31], [17, 30], [18, 30], [17, 30], [16, 31], [15, 31], [14, 30], [16, 28], [16, 27], [17, 26], [20, 26], [21, 27], [22, 27]], 'center': [31, 8]}, {'points': [[32, 4], [33, 3], [34, 4], [38, 4], [40, 6], [42, 6], [43, 7], [43, 8], [44, 9], [44, 10], [45, 11], [42, 14], [42, 15], [41, 16], [40, 16], [38, 14], [38, 13], [37, 13], [36, 14], [31, 14], [30, 13], [30, 7], [32, 5]], 'center': [31, 8]}, {'points': [[19, 23], [20, 22], [21, 23], [23, 23], [26, 26], [29, 26], [30, 27], [30, 28], [31, 28], [32, 29], [33, 29], [34, 30], [36, 30], [39, 33], [38, 34], [37, 34], [38, 35], [37, 36], [34, 36], [33, 37], [32, 36], [30, 36], [29, 35], [27, 35], [25, 33], [24, 33], [23, 32], [23, 31], [17, 31], [16, 30], [16, 25], [18, 23]], 'center': [31, 8]}, {'points': [[37, 5], [38, 4], [42, 4], [43, 5], [44, 5], [45, 6], [46, 6], [47, 7], [48, 7], [49, 8], [50, 8], [52, 10], [53, 10], [57, 14], [57, 15], [59, 17], [58, 18], [58, 19], [57, 20], [56, 20], [55, 19], [50, 19], [49, 20], [46, 20], [42, 16], [43, 15], [45, 15], [45, 13], [43, 13], [42, 14], [41, 14], [39, 12], [35, 12], [34, 11], [35, 10], [36, 10], [36, 9], [39, 6], [38, 6]], 'center': [31, 8]}, {'points': [[19, 9], [20, 8], [27, 8], [28, 9], [28, 10], [29, 10], [30, 11], [30, 12], [32, 14], [32, 16], [33, 17], [33, 20], [32, 21], [32, 23], [31, 24], [30, 24], [29, 25], [26, 25], [25, 24], [25, 23], [24, 22], [24, 21], [20, 21], [19, 20], [19, 18], [20, 17], [20, 15], [22, 13], [22, 12], [21, 12], [19, 10]], 'center': [31, 8]}, {'points': [[27, 18], [29, 18], [30, 19], [31, 18], [32, 18], [34, 20], [35, 20], [36, 21], [40, 21], [41, 20], [43, 22], [45, 22], [46, 23], [46, 24], [48, 24], [49, 25], [49, 26], [50, 27], [50, 29], [51, 30], [51, 31], [52, 32], [52, 34], [51, 35], [50, 35], [49, 34], [47, 34], [46, 33], [46, 34], [45, 35], [44, 35], [43, 36], [41, 36], [40, 35], [39, 35], [38, 34], [38, 33], [34, 33], [32, 31], [32, 30], [33, 29], [33, 27], [32, 28], [31, 27], [31, 26], [30, 26], [28, 24], [25, 24], [23, 22]], 'center': [31, 8]}, {'points': [[34, 10], [35, 10], [36, 11], [38, 11], [42, 15], [41, 16], [42, 17], [42, 21], [43, 22], [43, 23], [42, 24], [42, 25], [40, 27], [35, 27], [29, 21], [29, 19], [27, 17], [27, 14], [28, 13], [30, 13], [31, 12], [32, 12]], 'center': [31, 8]}, {'points': [[45, 24], [46, 25], [50, 25], [51, 26], [53, 26], [54, 27], [54, 28], [56, 28], [57, 27], [60, 27], [62, 29], [62, 30], [61, 31], [61, 34], [60, 35], [60, 36], [58, 38], [57, 38], [56, 37], [47, 37], [45, 39], [44, 38], [43, 38], [40, 35], [39, 35], [38, 34], [38, 33], [37, 32], [37, 29], [38, 28], [39, 29], [39, 30], [40, 30], [40, 29], [41, 28], [42, 28], [44, 30], [44, 28], [43, 27], [43, 26]], 'center': [31, 8]}, {'points': [[19, 9], [20, 8], [24, 8], [25, 9], [25, 10], [27, 10], [28, 11], [28, 12], [29, 12], [32, 15], [34, 15], [35, 16], [36, 16], [38, 18], [37, 19], [36, 19], [35, 20], [31, 20], [30, 21], [25, 21], [23, 19], [23, 18], [22, 17], [21, 17], [20, 16], [20, 18], [21, 19], [20, 20], [18, 20], [17, 19], [16, 19], [15, 18], [16, 17], [17, 17], [17, 16], [16, 16], [15, 17], [13, 15], [12, 16], [9, 13], [10, 12], [10, 11], [11, 10], [14, 10], [15, 9]], 'center': [31, 8]}, {'points': [[21, 30], [22, 29], [23, 29], [25, 31], [26, 31], [27, 32], [28, 32], [29, 31], [29, 30], [30, 29], [33, 29], [34, 30], [35, 29], [36, 30], [37, 30], [39, 32], [41, 32], [42, 33], [43, 33], [45, 35], [45, 38], [46, 39], [46, 40], [45, 41], [45, 43], [44, 44], [43, 44], [42, 45], [37, 45], [36, 44], [36, 45], [35, 46], [34, 45], [33, 45], [32, 44], [32, 43], [31, 43], [30, 42], [30, 41], [29, 41], [27, 39], [22, 39], [20, 37], [20, 35], [18, 33], [19, 32], [19, 31], [20, 30]], 'center': [31, 8]}, {'points': [[49, 26], [50, 27], [52, 27], [53, 28], [53, 29], [57, 33], [56, 34], [57, 34], [58, 33], [60, 35], [60, 36], [57, 39], [52, 39], [51, 40], [48, 40], [47, 39], [41, 39], [40, 38], [40, 37], [36, 33], [37, 32], [38, 32], [38, 31], [39, 30], [40, 30], [41, 29], [42, 29], [43, 28], [47, 28]], 'center': [31, 8]}, {'points': [[41, 10], [44, 10], [46, 12], [46, 13], [47, 14], [54, 14], [57, 17], [57, 18], [58, 18], [59, 19], [58, 20], [59, 21], [59, 24], [60, 25], [60, 28], [59, 29], [55, 29], [55, 30], [54, 31], [45, 31], [44, 30], [44, 20], [43, 20], [42, 19], [42, 17], [41, 18], [39, 18], [38, 17], [38, 15], [39, 14], [39, 12]], 'center': [31, 8]}, {'points': [[11, 18], [12, 17], [17, 22], [17, 23], [18, 23], [19, 22], [20, 22], [21, 23], [21, 25], [20, 26], [22, 26], [23, 27], [23, 28], [25, 30], [25, 31], [27, 33], [27, 36], [26, 37], [17, 37], [16, 36], [15, 36], [14, 35], [13, 35], [12, 34], [12, 33], [11, 33], [10, 34], [9, 34], [8, 33], [6, 33], [5, 32], [5, 31], [4, 30], [4, 29], [5, 28], [5, 27], [4, 26], [7, 23], [8, 23], [10, 21], [11, 21]], 'center': [31, 8]}, {'points': [[20, 19], [21, 18], [22, 18], [23, 19], [27, 19], [28, 20], [28, 21], [29, 22], [32, 22], [34, 24], [36, 24], [37, 25], [37, 26], [38, 26], [39, 27], [40, 27], [41, 28], [42, 28], [44, 30], [44, 32], [43, 33], [43, 35], [42, 36], [41, 35], [39, 35], [38, 34], [37, 34], [36, 33], [33, 33], [32, 32], [31, 32], [29, 30], [28, 30], [27, 29], [24, 29], [22, 27], [22, 26], [20, 26], [19, 25], [17, 25], [16, 24], [16, 23], [15, 22], [15, 21], [14, 20], [15, 19]], 'center': [31, 8]}, {'points': [[10, 10], [11, 11], [11, 12], [12, 12], [13, 13], [15, 13], [17, 15], [17, 16], [18, 17], [18, 18], [19, 19], [19, 20], [21, 22], [21, 24], [19, 26], [18, 26], [17, 25], [15, 25], [14, 26], [13, 26], [11, 28], [9, 28], [8, 27], [9, 26], [8, 25], [6, 25], [5, 24], [5, 22], [3, 20], [5, 18], [5, 17], [6, 16], [6, 15], [8, 13], [8, 12]], 'center': [31, 8]}, {'points': [[54, 15], [55, 15], [56, 16], [57, 15], [59, 17], [59, 18], [60, 19], [60, 20], [61, 21], [61, 23], [62, 24], [62, 32], [61, 33], [61, 34], [60, 35], [53, 35], [52, 34], [53, 33], [52, 32], [51, 32], [47, 28], [48, 27], [47, 26], [48, 25], [46, 25], [44, 23], [43, 23], [42, 22], [42, 21], [41, 21], [40, 20], [39, 21], [38, 20], [38, 19], [39, 18], [46, 18], [47, 17], [51, 17], [52, 18], [52, 19], [52, 17]], 'center': [31, 8]}, {'points': [[14, 22], [15, 21], [16, 22], [17, 22], [18, 23], [19, 23], [20, 24], [21, 24], [22, 25], [22, 27], [24, 29], [24, 32], [23, 33], [21, 33], [21, 34], [20, 35], [8, 35], [7, 34], [7, 33], [6, 32], [6, 30], [7, 29], [6, 28], [6, 27], [5, 26], [8, 23], [9, 23], [10, 22]], 'center': [31, 8]}, {'points': [[38, 8], [39, 7], [42, 7], [44, 9], [45, 9], [46, 10], [48, 10], [49, 11], [49, 13], [48, 14], [51, 17], [51, 18], [50, 19], [41, 19], [40, 20], [33, 20], [31, 18], [32, 17], [30, 17], [29, 16], [29, 13], [30, 12], [30, 11], [31, 10], [35, 10], [35, 9], [36, 8]], 'center': [31, 8]}, {'points': [[20, 3], [21, 2], [26, 2], [27, 3], [31, 3], [32, 4], [34, 2], [35, 3], [35, 4], [36, 4], [37, 5], [37, 6], [36, 7], [35, 7], [35, 9], [34, 10], [34, 11], [36, 13], [36, 16], [34, 18], [32, 16], [31, 16], [30, 15], [29, 15], [28, 16], [27, 15], [25, 15], [24, 14], [24, 13], [23, 12], [21, 12], [20, 11], [19, 12], [18, 12], [17, 11], [16, 11], [15, 10], [15, 8], [16, 7], [16, 6], [17, 5], [18, 5], [18, 4], [19, 3], [20, 4]], 'center': [31, 8]}, {'points': [[6, 17], [7, 18], [7, 19], [9, 21], [9, 22], [10, 23], [10, 19], [11, 18], [12, 19], [13, 19], [14, 20], [16, 20], [18, 22], [17, 23], [19, 23], [20, 24], [21, 24], [22, 25], [22, 27], [23, 28], [23, 29], [24, 30], [24, 31], [25, 32], [24, 33], [25, 34], [24, 35], [23, 35], [23, 37], [20, 40], [19, 40], [18, 39], [15, 39], [14, 38], [14, 36], [13, 36], [12, 35], [11, 36], [9, 36], [8, 37], [6, 37], [4, 35], [3, 35], [2, 34], [2, 32], [1, 31], [1, 25], [2, 24], [2, 21]], 'center': [31, 8]}, {'points': [[22, 2], [23, 1], [24, 1], [26, 3], [25, 4], [25, 5], [26, 6], [25, 7], [24, 7], [25, 7], [26, 8], [25, 9], [23, 9], [24, 9], [25, 10], [27, 10], [28, 11], [29, 11], [30, 12], [30, 14], [31, 14], [32, 15], [32, 17], [31, 18], [27, 18], [26, 17], [25, 17], [23, 19], [16, 19], [15, 20], [14, 19], [13, 19], [12, 18], [13, 17], [10, 17], [9, 16], [9, 15], [8, 14], [8, 12], [10, 10], [10, 9], [13, 6], [14, 6], [14, 5], [15, 4], [17, 4], [19, 2]], 'center': [31, 8]}]



// Doo eet.

createPaths();



function createPaths() {

	for (var i = 0; i < segments.length; i++) {

		var center = new Size(segments[i].center[0]*scalingfactor,segments[i].center[1]*scalingfactor);

                var path = createBlob(center, segments[i].points);

		//var lightness = (Math.random() - 0.5) * 0.4 + 0.4;

		var hue = Math.random() * 360;

		//path.fillColor = { hue: hue, saturation: 1, lightness: lightness };

                path.fillColor = {

                gradient: {stops: [['white', 0.01], [hue, 0.2], ['black', 1]],

                           radial: true},

                           origin: path.position,

                           destination: path.bounds.rightCenter

                };

		path.strokeColor = 'black';

                path.opacity = 0.5;

                path.blendMode = 'multiply';

	};

}



function createBlob(center, points) {

	var path = new Path();

	path.closed = true;

	for (var i = 0; i < points.length; i++) {

	    var delta = new Point({x:(points[i][0])*scalingfactor,y:(points[i][1])*scalingfactor});

	    path.add(center + delta);

	}

	path.smooth();

	return path;

}



var segment, path;

var movePath = false;

function onMouseDown(event) {

	segment = path = null;

	var hitResult = project.hitTest(event.point, hitOptions);

	if (!hitResult)

		return;



	if (event.modifiers.shift) {

		if (hitResult.type == 'segment') {

			hitResult.segment.remove();

		};

		return;

	}



	if (hitResult) {

		path = hitResult.item;

		if (hitResult.type == 'segment') {

			segment = hitResult.segment;

		} else if (hitResult.type == 'stroke') {

			var location = hitResult.location;

			segment = path.insert(location.index + 1, event.point);

			path.smooth();

		}

	}

	movePath = hitResult.type == 'fill';

	if (movePath)

		project.activeLayer.addChild(hitResult.item);

}



function onMouseMove(event) {

	project.activeLayer.selected = false;

	if (event.item)

		event.item.selected = true;

}



function onMouseDrag(event) {

	if (segment) {

		segment.point += event.delta;

		path.smooth();

	} else if (path) {

		path.position += event.delta;

	}

}

</script>

<div class="canvas">

<canvas resize="true" id="canvas-1" style="background:black"></canvas>

</div>

</div>

</article>

  </body>

</html>
